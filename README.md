# ATECC608 Tools 

Tools to work with Atmel Crypto-Authentication (ATCA) library and devices.

## Tools list

Primitives (simple commands):

- `aes_decrypt`: AES128 decrypt a block using a key in a given slot.
- `aes_encrypt`: AES128 encrypt a block using a key in a given slot.
- `check_mac`: Issue a Check MAC command that can also be used to authorize a key.
- `derivekey`: Create a new key from a parent, itself and tempkey.
- `gendig`: Issue a gendig-data command with the specified slot.
- `load_tempkey`: Load TempKey with a given value.
- `mac`: Generate a MAC of the TempKey + Slot Key
- `nonce_rand`: Generate a random nonce with a challenge.
- `random`: Retrieve a random number (or `FF FF 00 00 ...` if unlocked)
- `read_slot`: Read the first 32 bits from a data slot (cleartext)
- `serial`: Get the chip's serial number.
- `sha`: Calculate SHA256 of the message.
- `state`: Display device internal state.
- `write_8`: Write data in slot 08.
- `write_enc`: Write data using a writing key.
- `write_slot`: Write 32 bytes of data to any slot.


Use cases (multiple commands):

- `auth_aes_dec`: Decrypt a block of data using a secret symmetric key that requires Authorization
- `auth_aes_enc`: Encrypt a block of data using a secret symmetric key that requires Authorization
- `authorize.sh`: Performs a Check MAC with an authorization key in order to tell the device we know that key.
- `chip_info`: Dump some information about the device.
- `eyc_original.sh`: Verify an Original EyC component and retrieve verified data from a slot.
- `read_encrypted.sh`: Read the contents of any slot encrypted with a Read key.
- `rotate_key.sh`: Rotate a key from a parent key and a randon nonce.
- `setup_608`: Configure ATECC608 with the configuration below.


Tools (auxiliary):

- `xor`: Get two hexadecimal strings and return the xor.


## Setup 608 configuration

Slot | Key Type    | Read | Write | Usage
----:|-------------|------|-------|-------------
  00 | ECC Private | No   | Yes   | Device key. No usage restrictions.
  01 | AES         | 7    | 7     | Symmetric key.
  02 | AES         | 7    | 7     | Symmetric key with limited uses.
  03 | AES         | Yes  | Yes   | Symmetric key for debug.
  04 | SHA         | 7    | 7     | Secret. Require random.
  05 | SHA         | 7    | 7     | Secret with limited uses. Require random.
  06 | SHA         | Yes  | Yes   | Secret for debug.
  07 | SHA         | 7    | 7     | Secret for encrypted I/O.
  08 | Data        | Yes  | Yes   | Info: Date, Model, Trademark, uuid.
  09 | ECC Public  | Yes  | Yes   | Public key for ECC on key 1.
  10 | SHA         | 0    | 7     | Secret for Checkmac/Copy source.
  11 | SHA         | 0    | 7     | Secret for Checkmac/Copy destination.
  12 | AES         | No   | 13    | Symmetric key. Secret. Requires authorization by key 13.
  13 | SHA         | No   | 13    | Secret to protect key 12. Require random.
  14 | ECC Public  | Yes  | Yes   | External key storage.
  15 | Data        | Yes  | 7     | Secure info (you need to know key 7 to write it).

All slots are lockable.

OTP EEPROM value will be like this:
```
1.0|2024/03/21|Electronica y Ciencia|www.electronicayciencia.com
```

Counters 0 and 1 are initialized to 1000.

Keys 7 and 13 and initialized to a random value generated by the device and
only displayed at this moment..


## Customize

Edit `device_cfg.c` for your device. Then edit `atca_config.h` to enable proper
things.

## Build

### Compile the library

In Raspberry Pi with native I2C HAL:

```console
cd cryptoauthlib
cmake . -DATCA_HAL_I2C:BOOL=ON
make
```

The file `cryptoauthlib/lib/libcryptoauth.so` is created.

### Applications

`make`

That's it.

## Run

Export the library. Also setup `~/.bashrc`:

```bash
export LD_LIBRARY_PATH=$HOME/atca/cryptoauthlib/lib
```

